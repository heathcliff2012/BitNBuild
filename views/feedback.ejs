<!DOCTYPE html>
<html lang="en" class="auraFlow">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AuraFlow: Community Forum</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --background: radial-gradient(circle at 20% 30%, #2563eb, #22c55e);
            --accent: #06b6d4;
        }
        body { background: #0b1120 var(--background) fixed; color: #f8fafc; font-family: 'Inter', sans-serif; }
        .comment-card { background: rgba(15, 23, 42, 0.4); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); transition: all 0.3s ease; }
        .comment-card:hover { border-color: var(--accent); }
    </style>
</head>
<body class="antialiased min-h-screen">

    <div class="max-w-4xl mx-auto p-6 lg:p-12">
        <header class="text-center mb-12">
            <h1 class="text-5xl font-extrabold italic mb-3">Community Forum</h1>
            <p class="text-emerald-200/60">Your feedback helps shape a better city budget.</p>
            <div class="flex items-center space-x-2">
            <a href="/dashboard-public" class="bg-slate-800/50 text-white font-semibold py-2 px-4 rounded-lg flex items-center gap-2 border border-white/10 hover:border-accent transition">
                <i data-lucide="home" class="w-4 h-4"></i> Home
            </a>
     </div>
        </header>

        <main class="space-y-8">
            <div class="comment-card rounded-3xl p-6 border-accent/20">
                <form action="/community-feedback" method="POST">
                    <textarea name="text" class="w-full bg-black/30 rounded-2xl p-4 text-white placeholder-white/20 border border-white/5 focus:border-accent outline-none transition" rows="3" placeholder="Add your feedback..." required></textarea>
                    <div class="flex justify-end mt-4">
                        <button type="submit" class="bg-accent text-white font-bold py-2 px-8 rounded-xl hover:scale-105 transition flex items-center gap-2">
                            <i data-lucide="send" class="w-4 h-4"></i> Post to Forum
                        </button>
                    </div>
                </form>
            </div>

<div id="comments-container" class="space-y-6">
    <% if (comments && comments.length > 0) { %>
        <% comments.forEach(comment => { %>
            <article class="comment-card rounded-2xl p-6">
                <header class="flex justify-between items-start mb-3">
                    <div>
                        <p class="font-bold text-cyan-300"><%= comment.username || 'Anonymous' %></p>
                        <time datetime="<%= new Date(comment.createdAt).toISOString() %>" class="text-xs text-white/40">
                            <%= new Date(comment.createdAt).toLocaleString(undefined, { dateStyle: 'medium', timeStyle: 'short' }) %>
                        </time>
                    </div>
                </header>
                <div class="prose prose-invert max-w-none text-slate-200">
                    <p><%= comment.text %></p>
                </div>
            </article>
        <% }) %>
    <% } else { %>
        <div class="text-center py-16 border-2 border-dashed border-white/10 rounded-2xl">
            <i data-lucide="message-square-dashed" class="w-12 h-12 mx-auto text-white/20 mb-4"></i>
            <p class="text-white/40">No feedback yet. Be the first to share your thoughts!</p>
        </div>
    <% } %>
</div>
        </main>
    </div>

    <script>lucide.createIcons();</script>
</body>
</html>